const _constants={passiveEventOption:function(){let t=!1;try{let e=Object.defineProperty({},"passive",{get:function(){t=!0}});return window.addEventListener("test",null,e),!!t&&{passive:!0}}catch(t){return!1}}(),isTouchDevice:"ontouchstart"in window||navigator.maxTouchPoints};class Helper{static updateTransformProperty(t,e){return _updateTransformProperty(t,e)}}function _updateTransformProperty(t,e){let s={};t.style.transform&&(s=t.style.transform.trim().match(/.+?\(.+?\)/g).map(t=>t.trim().split(/[()]+/).filter(t=>t)).reduce((t,e)=>(t[e[0]]=e[1],t),{}));let i=e.trim().match(/.+?\(.+?\)/g).map(t=>t.trim().split(/[()]+/).filter(t=>t)).reduce((t,e)=>(t[e[0]]=e[1],t),{}),o=Object.assign({},s,i),r="";for(const t of Object.keys(o))r+=`${t}(${o[t]}) `;return r.slice(0,-1),t.style.transform=r,!0}class Easing{static easeOutElastic(t,e,s,i){let o=1.70158,r=0,n=s;return 0==t?e:1==(t/=i)?e+s:(r||(r=.3*i),n<Math.abs(s)?(n=s,o=r/4):o=r/(2*Math.PI)*Math.asin(s/n),n*Math.pow(2,-10*t)*Math.sin((t*i-o)*(2*Math.PI)/r)+s+e)}}class CardTouchSupport{constructor(t){this.card=t,this.animTime=1e3,this.xDown=!1,this.isMoving=!1,this.touchStartDeg=0,this.time=0,this.degGap=0,this.degStart=0,this.requestAnimationFrameID=0,this.touchstartHandler=this.touchstartHandler.bind(this),this.touchmoveHandler=this.touchmoveHandler.bind(this),this.touchendHandler=this.touchendHandler.bind(this)}touchstartHandler(t){this.requestAnimationFrameID&&window.cancelAnimationFrame(this.requestAnimationFrameID),this.xDown=t.touches[0].clientX,this.touchStartDeg=this.card.deg}touchmoveHandler(t){if(!this.xDown||this.isMoving)return;this.isMoving=!0;const e=t.touches[0].clientX-this.xDown,s=this.touchStartDeg+e;Helper.updateTransformProperty(this.card.front,`rotateY(${s}deg)`),Helper.updateTransformProperty(this.card.back,`rotateY(${s+180}deg)`),this.card.deg=s,this.isMoving=!1}touchendHandler(t){this.xDown&&(this.xDown=null,0<=this.card.deg&&this.card.deg<90?this.degGap=-this.card.deg:90<=this.card.deg&&this.card.deg<180?this.degGap=180-this.card.deg:180<=this.card.deg&&this.card.deg<270?this.degGap=180-this.card.deg:this.degGap=360-this.card.deg,this.degStart=this.card.deg,this.time=performance.now(),this.requestAnimationFrameID=window.requestAnimationFrame(t=>this.animateReturnToPlank(t)))}animateReturnToPlank(t){if(t-this.time>this.animTime)return this.time=0,void(this.requestAnimationFrameID=0);const e=Easing.easeOutElastic(t-this.time,this.degStart,this.degGap,this.animTime);Helper.updateTransformProperty(this.card.front,`rotateY(${e}deg)`),Helper.updateTransformProperty(this.card.back,`rotateY(${e+180}deg)`),this.card.deg=e,this.requestAnimationFrameID=window.requestAnimationFrame(t=>this.animateReturnToPlank(t))}}class CardMouseSupport{constructor(t){this.card=t,this.animTime=3e3,this.time=0,this.degGap=180,this.degStart=0,this.requestAnimationFrameID=0,this.mouseenterHandler=this.mouseenterHandler.bind(this),this.mouseleaveHandler=this.mouseleaveHandler.bind(this)}mouseenterHandler(t){this.requestAnimationFrameID&&window.cancelAnimationFrame(this.requestAnimationFrameID),this.degStart=this.card.deg,this.degGap=180-this.card.deg,0!==this.degGap&&(this.time=performance.now(),this.requestAnimationFrameID=window.requestAnimationFrame(t=>this.animateFlip(t)))}mouseleaveHandler(t){this.requestAnimationFrameID&&window.cancelAnimationFrame(this.requestAnimationFrameID),this.degStart=this.card.deg,this.degGap=-this.card.deg,0!==this.degGap&&(this.time=performance.now(),this.requestAnimationFrameID=window.requestAnimationFrame(t=>this.animateFlip(t)))}animateFlip(t){t-this.time>this.animTime&&(this.time=0,this.requestAnimationFrameID=0);const e=Easing.easeOutElastic(t-this.time,this.degStart,this.degGap,this.animTime);Helper.updateTransformProperty(this.card.front,`rotateY(${e}deg)`),Helper.updateTransformProperty(this.card.back,`rotateY(${e+180}deg)`),this.card.deg=e,this.requestAnimationFrameID=window.requestAnimationFrame(t=>this.animateFlip(t))}}class Card{constructor(t,e,s){this.container=t,this.front=e,this.back=s,this.touchSupport=null,this.mouseSupport=null,this._deg=0}get deg(){return this._deg}set deg(t){this._deg=(t%360+360)%360}addTouchSupport(){!this.touchSupport&&_constants.isTouchDevice&&(this.touchSupport=new CardTouchSupport(this),this.container.addEventListener("touchstart",this.touchSupport.touchstartHandler,_constants.passiveEventOption),this.container.addEventListener("touchmove",this.touchSupport.touchmoveHandler,_constants.passiveEventOption),this.container.addEventListener("touchend",this.touchSupport.touchendHandler,_constants.passiveEventOption))}removeTouchSupport(){this.touchSupport&&(this.container.removeEventListener("touchstart",this.touchSupport.touchstartHandler,_constants.passiveEventOption),this.container.removeEventListener("touchmove",this.touchSupport.touchmoveHandler,_constants.passiveEventOption),this.container.removeEventListener("touchend",this.touchSupport.touchendHandler,_constants.passiveEventOption),this.touchSupport=null)}addMouseSupport(){this.mouseSupport||_constants.isTouchDevice||(this.mouseSupport=new CardMouseSupport(this),this.container.addEventListener("mouseenter",this.mouseSupport.mouseenterHandler,_constants.passiveEventOption),this.container.addEventListener("mouseleave",this.mouseSupport.mouseleaveHandler,_constants.passiveEventOption))}removeMouseSupport(){this.mouseSupport&&(this.container.removeEventListener("mouseenter",this.mouseSupport.mouseenterHandler,_constants.passiveEventOption),this.container.removeEventListener("mouseleave",this.mouseSupport.mouseleaveHandler,_constants.passiveEventOption),this.mouseSupport=null)}}const defaults={container:".flip-card",front:".flip-card-front",back:".flip-card-back",addCssBasic:!0,addCssPositioning:!1,addTouchSupport:!0,addMouseSupport:!0,domObjects:{cardList:[]}};class FlipCard{constructor(t={}){this.options=Object.assign({},defaults,t),this.updateDomObjects(),this.options.addCssBasic&&_addCssBasic(this.options),this.options.addCssPositioning&&_addCssPositioning(this.options),this.options.addTouchSupport&&this.touchSupport.add(),this.options.addMouseSupport&&this.mouseSupport.add()}updateDomObjects(){if(0===this.options.domObjects.cardList.length){let t=document.querySelectorAll(this.options.container);for(const e of t){const t=e.querySelector(this.options.front),s=e.querySelector(this.options.back);this.options.domObjects.cardList.push(new Card(e,t,s))}}else console.error("ToDo! Not implemented yet, if there are already objects. updateDomObjects()");return this}get touchSupport(){const t=this;return{add(){for(const e of t.options.domObjects.cardList)e.addTouchSupport();return t},remove(){for(const e of t.options.domObjects.cardList)e.removeTouchSupport();return t}}}get mouseSupport(){const t=this;return{add(){for(const e of t.options.domObjects.cardList)e.addMouseSupport();return t},remove(){for(const e of t.options.domObjects.cardList)e.removeMouseSupport();return t}}}}function _addCssBasic(t){for(const e of t.domObjects.cardList)e.container.style.perspective="400px",e.front.style.backfaceVisibility="hidden",e.back.style.backfaceVisibility="hidden",Helper.updateTransformProperty(e.front,"rotateY(0)"),Helper.updateTransformProperty(e.back,"rotateY(180deg)")}function _addCssPositioning(t){for(const e of t.domObjects.cardList){e.container.style.position="relative";let t=e.front.getBoundingClientRect(),s=e.back.getBoundingClientRect(),i=Math.max(t.width,s.width),o=Math.max(t.height,s.height);e.container.style.width=i+"px",e.container.style.height=o+"px",e.front.style.position="absolute",e.front.style.top="50%",e.front.style.left="50%",e.front.style.transformOrigin="left center",Helper.updateTransformProperty(e.front,"translate(-50%, -50%)"),e.back.style.position="absolute",e.back.style.top="50%",e.back.style.left="50%",e.back.style.transformOrigin="left center",Helper.updateTransformProperty(e.back,"translate(-50%, -50%)")}}export default FlipCard;
//# sourceMappingURL=flipcard-es6m.min.js.map
