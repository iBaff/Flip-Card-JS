"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _addCssBasic(t){var e=!0,r=!1,n=void 0;try{for(var i,a=t.domObjects.cardList[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;o.container.style.perspective="400px",o.front.style.backfaceVisibility="hidden",o.back.style.backfaceVisibility="hidden",_helper.Helper.updateTransformProperty(o.front,"rotateY(0)"),_helper.Helper.updateTransformProperty(o.back,"rotateY(180deg)")}}catch(t){r=!0,n=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw n}}}function _addCssPositioning(t){var e=!0,r=!1,n=void 0;try{for(var i,a=t.domObjects.cardList[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;o.container.style.position="relative";var s=o.front.getBoundingClientRect(),u=o.back.getBoundingClientRect(),c=Math.max(s.width,u.width),l=Math.max(s.height,u.height);o.container.style.width=c+"px",o.container.style.height=l+"px",o.front.style.position="absolute",o.front.style.top="50%",o.front.style.left="50%",o.front.style.transformOrigin="left center",_helper.Helper.updateTransformProperty(o.front,"translate(-50%, -50%)"),o.back.style.position="absolute",o.back.style.top="50%",o.back.style.left="50%",o.back.style.transformOrigin="left center",_helper.Helper.updateTransformProperty(o.back,"translate(-50%, -50%)")}}catch(t){r=!0,n=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw n}}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _updateTransformProperty(t,e){var r={};t.style.transform&&(r=t.style.transform.trim().match(/.+?\(.+?\)/g).map(function(t){return t.trim().split(/[()]+/).filter(function(t){return t})}).reduce(function(t,e){return t[e[0]]=e[1],t},{}));var n=e.trim().match(/.+?\(.+?\)/g).map(function(t){return t.trim().split(/[()]+/).filter(function(t){return t})}).reduce(function(t,e){return t[e[0]]=e[1],t},{}),i=Object.assign({},r,n),a="",o=!0,s=!1,u=void 0;try{for(var c,l=Object.keys(i)[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;a+=h+"("+i[h]+") "}}catch(t){s=!0,u=t}finally{try{!o&&l.return&&l.return()}finally{if(s)throw u}}return a.slice(0,-1),t.style.transform=a,!0}Object.defineProperty(exports,"__esModule",{value:!0}),exports.CardMouseSupport=void 0;var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_easing=require("./easing.js"),_helper=require("./helper.js"),CardMouseSupport=exports.CardMouseSupport=function(){function t(e){_classCallCheck(this,t),this.card=e,this.animTime=3e3,this.time=0,this.degGap=180,this.degStart=0,this.requestAnimationFrameID=0,this.mouseenterHandler=this.mouseenterHandler.bind(this),this.mouseleaveHandler=this.mouseleaveHandler.bind(this)}return _createClass(t,[{key:"mouseenterHandler",value:function(t){var e=this;this.requestAnimationFrameID&&window.cancelAnimationFrame(this.requestAnimationFrameID),this.degStart=this.card.deg,this.degGap=180-this.card.deg,0!==this.degGap&&(this.time=performance.now(),this.requestAnimationFrameID=window.requestAnimationFrame(function(t){return e.animateFlip(t)}))}},{key:"mouseleaveHandler",value:function(t){var e=this;this.requestAnimationFrameID&&window.cancelAnimationFrame(this.requestAnimationFrameID),this.degStart=this.card.deg,this.degGap=-this.card.deg,0!==this.degGap&&(this.time=performance.now(),this.requestAnimationFrameID=window.requestAnimationFrame(function(t){return e.animateFlip(t)}))}},{key:"animateFlip",value:function(t){var e=this;t-this.time>this.animTime&&(this.time=0,this.requestAnimationFrameID=0);var r=_easing.Easing.easeOutElastic(t-this.time,this.degStart,this.degGap,this.animTime);_helper.Helper.updateTransformProperty(this.card.front,"rotateY("+r+"deg)"),_helper.Helper.updateTransformProperty(this.card.back,"rotateY("+(r+180)+"deg)"),this.card.deg=r,this.requestAnimationFrameID=window.requestAnimationFrame(function(t){return e.animateFlip(t)})}}]),t}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.CardTouchSupport=void 0;var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_helper=require("./helper.js"),_easing=require("./easing.js"),CardTouchSupport=exports.CardTouchSupport=function(){function t(e){_classCallCheck(this,t),this.card=e,this.animTime=1e3,this.xDown=!1,this.isMoving=!1,this.touchStartDeg=0,this.time=0,this.degGap=0,this.degStart=0,this.requestAnimationFrameID=0,this.touchstartHandler=this.touchstartHandler.bind(this),this.touchmoveHandler=this.touchmoveHandler.bind(this),this.touchendHandler=this.touchendHandler.bind(this)}return _createClass(t,[{key:"touchstartHandler",value:function(t){this.requestAnimationFrameID&&window.cancelAnimationFrame(this.requestAnimationFrameID),this.xDown=t.touches[0].clientX,this.touchStartDeg=this.card.deg}},{key:"touchmoveHandler",value:function(t){if(this.xDown&&!this.isMoving){this.isMoving=!0;var e=t.touches[0].clientX-this.xDown,r=this.touchStartDeg+e;_helper.Helper.updateTransformProperty(this.card.front,"rotateY("+r+"deg)"),_helper.Helper.updateTransformProperty(this.card.back,"rotateY("+(r+180)+"deg)"),this.card.deg=r,this.isMoving=!1}}},{key:"touchendHandler",value:function(t){var e=this;this.xDown&&(this.xDown=null,0<=this.card.deg&&this.card.deg<90?this.degGap=-this.card.deg:90<=this.card.deg&&this.card.deg<180?this.degGap=180-this.card.deg:180<=this.card.deg&&this.card.deg<270?this.degGap=180-this.card.deg:this.degGap=360-this.card.deg,this.degStart=this.card.deg,this.time=performance.now(),this.requestAnimationFrameID=window.requestAnimationFrame(function(t){return e.animateReturnToPlank(t)}))}},{key:"animateReturnToPlank",value:function(t){var e=this;if(t-this.time>this.animTime)return this.time=0,void(this.requestAnimationFrameID=0);var r=_easing.Easing.easeOutElastic(t-this.time,this.degStart,this.degGap,this.animTime);_helper.Helper.updateTransformProperty(this.card.front,"rotateY("+r+"deg)"),_helper.Helper.updateTransformProperty(this.card.back,"rotateY("+(r+180)+"deg)"),this.card.deg=r,this.requestAnimationFrameID=window.requestAnimationFrame(function(t){return e.animateReturnToPlank(t)})}}]),t}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.Card=void 0;var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_cardTouchSupport=require("./card-touch-support.js"),_helper=require("./helper.js"),_cardMouseSupport=require("./card-mouse-support.js"),Card=exports.Card=function(){function t(e,r,n){_classCallCheck(this,t),this.container=e,this.front=r,this.back=n,this.touchSupport=null,this.mouseSupport=null,this._deg=0}return _createClass(t,[{key:"addTouchSupport",value:function(){!this.touchSupport&&_helper._constants.isTouchDevice&&(this.touchSupport=new _cardTouchSupport.CardTouchSupport(this),this.container.addEventListener("touchstart",this.touchSupport.touchstartHandler,_helper._constants.passiveEventOption),this.container.addEventListener("touchmove",this.touchSupport.touchmoveHandler,_helper._constants.passiveEventOption),this.container.addEventListener("touchend",this.touchSupport.touchendHandler,_helper._constants.passiveEventOption))}},{key:"removeTouchSupport",value:function(){this.touchSupport&&(this.container.removeEventListener("touchstart",this.touchSupport.touchstartHandler,_helper._constants.passiveEventOption),this.container.removeEventListener("touchmove",this.touchSupport.touchmoveHandler,_helper._constants.passiveEventOption),this.container.removeEventListener("touchend",this.touchSupport.touchendHandler,_helper._constants.passiveEventOption),this.touchSupport=null)}},{key:"addMouseSupport",value:function(){this.mouseSupport||_helper._constants.isTouchDevice||(this.mouseSupport=new _cardMouseSupport.CardMouseSupport(this),this.container.addEventListener("mouseenter",this.mouseSupport.mouseenterHandler,_helper._constants.passiveEventOption),this.container.addEventListener("mouseleave",this.mouseSupport.mouseleaveHandler,_helper._constants.passiveEventOption))}},{key:"removeMouseSupport",value:function(){this.mouseSupport&&(this.container.removeEventListener("mouseenter",this.mouseSupport.mouseenterHandler,_helper._constants.passiveEventOption),this.container.removeEventListener("mouseleave",this.mouseSupport.mouseleaveHandler,_helper._constants.passiveEventOption),this.mouseSupport=null)}},{key:"deg",get:function(){return this._deg},set:function(t){this._deg=(t%360+360)%360}}]),t}();Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),Easing=exports.Easing=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"easeOutElastic",value:function(t,e,r,n){var i=1.70158,a=0,o=r;return 0==t?e:1==(t/=n)?e+r:(a||(a=.3*n),o<Math.abs(r)?(o=r,i=a/4):i=a/(2*Math.PI)*Math.asin(r/o),o*Math.pow(2,-10*t)*Math.sin((t*n-i)*(2*Math.PI)/a)+r+e)}}]),t}();Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_card=require("./card.js"),_helper=require("./helper.js"),defaults={container:".flip-card",front:".flip-card-front",back:".flip-card-back",addCssBasic:!0,addCssPositioning:!1,addTouchSupport:!0,addMouseSupport:!0,domObjects:{cardList:[]}},FlipCard=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t),this.options=Object.assign({},defaults,e),this.updateDomObjects(),this.options.addCssBasic&&_addCssBasic(this.options),this.options.addCssPositioning&&_addCssPositioning(this.options),this.options.addTouchSupport&&this.touchSupport.add(),this.options.addMouseSupport&&this.mouseSupport.add()}return _createClass(t,[{key:"updateDomObjects",value:function(){if(0===this.options.domObjects.cardList.length){var t=document.querySelectorAll(this.options.container),e=!0,r=!1,n=void 0;try{for(var i,a=t[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value,s=o.querySelector(this.options.front),u=o.querySelector(this.options.back);this.options.domObjects.cardList.push(new _card.Card(o,s,u))}}catch(t){r=!0,n=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw n}}}else console.error("ToDo! Not implemented yet, if there are already objects. updateDomObjects()");return this}},{key:"touchSupport",get:function(){var t=this;return{add:function(){var e=!0,r=!1,n=void 0;try{for(var i,a=t.options.domObjects.cardList[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){i.value.addTouchSupport()}}catch(t){r=!0,n=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw n}}return t},remove:function(){var e=!0,r=!1,n=void 0;try{for(var i,a=t.options.domObjects.cardList[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){i.value.removeTouchSupport()}}catch(t){r=!0,n=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw n}}return t}}}},{key:"mouseSupport",get:function(){var t=this;return{add:function(){var e=!0,r=!1,n=void 0;try{for(var i,a=t.options.domObjects.cardList[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){i.value.addMouseSupport()}}catch(t){r=!0,n=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw n}}return t},remove:function(){var e=!0,r=!1,n=void 0;try{for(var i,a=t.options.domObjects.cardList[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){i.value.removeMouseSupport()}}catch(t){r=!0,n=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw n}}return t}}}}]),t}();exports.default=FlipCard,Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),_constants=exports._constants={passiveEventOption:function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});return window.addEventListener("test",null,e),!!t&&{passive:!0}}catch(t){return!1}}(),isTouchDevice:"ontouchstart"in window||navigator.maxTouchPoints},Helper=exports.Helper=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"updateTransformProperty",value:function(t,e){return _updateTransformProperty(t,e)}}]),t}();
//# sourceMappingURL=flip-card.js.map
